<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Meus Produtos ‚Äî DIGIVEND</title>
<style>
  body{margin:0;background:#000;color:#fff;font-family:Inter,Arial;overflow-x:hidden}
  .topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:#0b1220;border-bottom:1px solid #071019;position:sticky;top:0;z-index:30}
  .logo{position:absolute;left:50%;transform:translateX(-50%);color:#0ea5e9;font-weight:700;font-size:20px}
  .menu-btn{font-size:20px;cursor:pointer}
  .right-actions{display:flex;gap:12px;align-items:center}
  .icon-btn{background:transparent;border:0;color:#fff;font-size:20px;cursor:pointer;position:relative}
  .badge{position:absolute;top:-6px;right:-6px;background:#ef4444;color:#fff;border-radius:999px;padding:2px 6px;font-size:12px}
  .sidebar{position:fixed;left:0;top:0;height:100%;width:260px;background:#071021;transform:translateX(-120%);transition:transform .25s;z-index:40;padding:18px}
  .sidebar.open{transform:translateX(0)}
  .sidebar h3{color:#0ea5e9;margin:0 0 12px}
  .sidebar nav a{display:block;color:#cbd5e1;padding:10px;border-radius:8px;text-decoration:none;margin-bottom:6px}
  .sidebar nav a:hover{background:#071a2a;color:#fff}
  .container{max-width:1100px;margin:20px auto;padding:0 16px}
  .search-row{display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap;margin-bottom:12px}
  input[type="text"]{min-width:260px;width:48%;max-width:580px;padding:10px;border-radius:8px;border:0;background:#071826;color:#fff}
  .btn{background:#0ea5e9;color:#00121a;padding:10px 14px;border-radius:8px;border:0;cursor:pointer}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
  @media(max-width:980px){.grid{grid-template-columns:repeat(2,1fr)};input[type="text"]{width:70%}}
  @media(max-width:640px){.grid{grid-template-columns:1fr};input[type="text"]{width:100%}}
  .card{background:#0b1220;padding:12px;border-radius:12px;display:flex;flex-direction:column;gap:8px}
  .card img{width:100%;height:130px;object-fit:cover;border-radius:8px}
  .card h4{color:#0ea5e9;margin:0}
  .meta{color:#9ca3af;font-size:13px}
  .card-actions{display:flex;gap:8px}
  .small-btn{flex:1;padding:8px;border-radius:8px;border:0;cursor:pointer;font-size:13px}
  .small-btn.copy{background:#e6f6fb;color:#00303a}
  .small-btn.edit{background:#0ea5e9;color:#00121a}
  .small-btn.delete{background:#ef4444;color:#fff}
</style>
</head>
<body>

<div class="topbar">
  <div style="display:flex;align-items:center;gap:12px">
    <div id="menuBtn" class="menu-btn">‚ò∞</div>
  </div>
  <div class="logo">DIGIVEND</div>
  <div class="right-actions">
    <button id="bellBtn" class="icon-btn">üîî<span id="bellCount" class="badge" style="display:none">0</span></button>
    <button id="profileBtn" class="icon-btn">üë§</button>
  </div>
</div>

<aside id="sidebar" class="sidebar" aria-hidden="true">
  <h3>DIGIVEND</h3>
  <nav>
    <a href="dashboard_vendedor.html">üè† Dashboard</a>
    <a href="meus_produtos.html">üì¶ Meus Produtos</a>
    <a href="notificacoes.html">‚úâÔ∏è Notifica√ß√µes</a>
    <a href="marketplace.html">üõí Marketplace / Loja</a>
    <a href="configuracoes.html">‚öôÔ∏è Configura√ß√µes</a>
    <a href="index.html">üö™ Sair</a>
  </nav>
</aside>

<div class="container">
  <div class="search-row">
    <input id="searchInput" type="text" placeholder="Pesquisar produto..." />
    <select id="categorySelect"><option value="">Todas categorias</option><option>Empreender</option><option>Neg√≥cios</option><option>Sa√∫de</option><option>Educa√ß√£o</option><option>Outros</option></select>
    <div><button id="createBtn" class="btn">+ Criar</button></div>
  </div>

  <div id="productsGrid" class="grid"></div>
</div>

<script>
/* Reuse same LS key and rendering logic as adicionar_produto.html */
const LS_KEY = 'digivend_produtos_v2';
function getProducts(){ return JSON.parse(localStorage.getItem(LS_KEY)||'[]'); }
function renderProducts(){
  const box = document.getElementById('productsGrid'); box.innerHTML='';
  const arr = getProducts();
  if(arr.length===0){ box.innerHTML='<div style="grid-column:1/-1;color:#94a3b8;text-align:center;padding:20px">Nenhum produto criado.</div>'; return; }
  arr.forEach((p,idx)=>{
    const card=document.createElement('div'); card.className='card';
    const img=document.createElement('img'); img.src=p.imageData||'';
    const h=document.createElement('h4'); h.textContent=p.name;
    const meta=document.createElement('div'); meta.className='meta'; meta.textContent=`${p.type} ‚Ä¢ ${p.category} ‚Ä¢ ${p.author||''}`;
    const desc=document.createElement('div'); desc.className='meta'; desc.textContent=(p.description||'').slice(0,120)+(p.description&&p.description.length>120?'...':'');
    const price=document.createElement('div'); price.innerHTML=`<strong style="color:#c7f9ff">${p.price} MT</strong>`;
    const status=document.createElement('div'); status.style.marginTop='6px'; status.innerHTML=`<span style="padding:6px 8px;border-radius:999px;font-weight:600;font-size:12px" class="${p.status==='Pendente'?'':' ' }">${p.status}</span>`;
    // actions
    const actions=document.createElement('div'); actions.className='card-actions';
    const copy=document.createElement('button'); copy.className='small-btn copy'; copy.textContent='üìã Copiar link'; copy.onclick=()=>{ navigator.clipboard.writeText(`${location.origin}${location.pathname.replace(/[^\/]*$/,'')}produto.html?id=${encodeURIComponent(p.id)}`); alert('Link copiado') };
    const edit=document.createElement('button'); edit.className='small-btn edit'; edit.textContent='‚úèÔ∏è Editar';
    if(p.status==='Pendente'){ edit.disabled=true; edit.style.opacity='.5'; edit.title='Edi√ß√£o bloqueada enquanto Pendente'; } else edit.onclick=()=>{ localStorage.setItem('edit_index', idx); location.href='adicionar_produto.html?edit='+encodeURIComponent(p.id) };
    const del=document.createElement('button'); del.className='small-btn delete'; del.textContent='üóëÔ∏è Remover'; del.onclick=()=>{ if(confirm('Remover produto?')){ const a=getProducts(); a.splice(idx,1); localStorage.setItem(LS_KEY,JSON.stringify(a)); renderProducts(); } };
    actions.appendChild(copy); actions.appendChild(edit); actions.appendChild(del);
    card.appendChild(img); card.appendChild(h); card.appendChild(meta); card.appendChild(desc); card.appendChild(price); card.appendChild(status); card.appendChild(actions);
    box.appendChild(card);
  });
}

/* UI wiring */
document.getElementById('menuBtn').onclick = ()=> document.getElementById('sidebar').classList.toggle('open');
document.getElementById('createBtn').onclick = ()=> location.href='adicionar_produto.html';
document.getElementById('bellBtn').onclick = ()=> alert('Notifica√ß√µes (placeholder)');
document.getElementById('profileBtn').onclick = ()=> alert('Perfil (placeholder)');

/* search/filter */
document.getElementById('searchInput').addEventListener('input', applyFilters);
document.getElementById('categorySelect').addEventListener('change', applyFilters);

function applyFilters(){
  const term = document.getElementById('searchInput').value.toLowerCase();
  const cat = document.getElementById('categorySelect').value;
  const arr = getProducts().filter(p=>{
    return (!term || (p.name && p.name.toLowerCase().includes(term))) && (!cat || p.category===cat);
  });
  // render arr
  const box = document.getElementById('productsGrid'); box.innerHTML='';
  if(arr.length===0){ box.innerHTML='<div style="grid-column:1/-1;color:#94a3b8;text-align:center;padding:20px">Nenhum produto encontrado.</div>'; return; }
  arr.forEach((p,idx)=>{ // same render code shortened
    const card=document.createElement('div'); card.className='card';
    card.innerHTML = `<img src="${p.imageData||''}" alt=""><h4>${p.name}</h4><div class="meta">${p.type} ‚Ä¢ ${p.category}</div><div class="meta">${(p.description||'').slice(0,120)}...</div><div style="margin-top:6px"><strong style="color:#c7f9ff">${p.price} MT</strong></div><div style="margin-top:6px"><span class="meta">${p.status}</span></div>`;
    const actions=document.createElement('div'); actions.className='card-actions';
    const copy=document.createElement('button'); copy.className='small-btn copy'; copy.textContent='üìã Copiar link'; copy.onclick=()=>{navigator.clipboard.writeText(`${location.origin}${location.pathname.replace(/[^\/]*$/,'')}produto.html?id=${encodeURIComponent(p.id)}`);alert('Link copiado');};
    const edit=document.createElement('button'); edit.className='small-btn edit'; edit.textContent='‚úèÔ∏è Editar';
    if(p.status==='Pendente'){ edit.disabled=true; edit.style.opacity='.5'; } else edit.onclick=()=>{ const a=getProducts(); const origIndex = a.findIndex(x=>x.id===p.id); localStorage.setItem('edit_index', origIndex); location.href='adicionar_produto.html?edit='+encodeURIComponent(p.id); };
    const del=document.createElement('button'); del.className='small-btn delete'; del.textContent='üóëÔ∏è Remover'; del.onclick=()=>{ if(confirm('Remover produto?')){ const a=getProducts(); const id = a.findIndex(x=>x.id===p.id); a.splice(id,1); localStorage.setItem(LS_KEY,JSON.stringify(a)); renderProducts(); } };
    actions.appendChild(copy); actions.appendChild(edit); actions.appendChild(del);
    card.appendChild(actions);
    box.appendChild(card);
  });
}

renderProducts();
</script>

</body>
</html>
